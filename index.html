<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Samplern ‚Äî n8n Automation Agency</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500&display=swap" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollToPlugin.min.js"></script>
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  :root {
    --bg: #07070f;
    --bg2: #0d0d1a;
    --purple: #7c3aed;
    --purple-light: #a855f7;
    --cyan: #06b6d4;
    --cyan-light: #22d3ee;
    --text: #f1f5f9;
    --muted: #64748b;
    --border: rgba(255,255,255,0.07);
    --card: rgba(255,255,255,0.03);
    --grad: linear-gradient(135deg, var(--purple), var(--cyan));
  }

  html { scroll-behavior: smooth; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Inter', sans-serif;
    overflow-x: hidden;
    line-height: 1.6;
  }

  /* Scrollbar */
  ::-webkit-scrollbar { width: 4px; }
  ::-webkit-scrollbar-track { background: var(--bg); }
  ::-webkit-scrollbar-thumb { background: var(--purple); border-radius: 2px; }

  /* Nav */
  nav {
    position: fixed; top: 0; left: 0; right: 0; z-index: 100;
    padding: 20px 60px;
    display: flex; align-items: center; justify-content: space-between;
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    background: rgba(7,7,15,0.8);
    transition: all 0.3s;
  }
  .nav-logo {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 1.4rem; font-weight: 700;
    background: var(--grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    letter-spacing: -0.02em;
  }
  .nav-links { display: flex; gap: 40px; list-style: none; }
  .nav-links a {
    text-decoration: none; color: var(--muted); font-size: 0.9rem;
    font-weight: 500; transition: color 0.2s; letter-spacing: 0.02em;
  }
  .nav-links a:hover { color: var(--text); }
  .nav-cta {
    background: var(--grad); border: none; cursor: pointer;
    padding: 10px 24px; border-radius: 8px;
    font-family: 'Space Grotesk', sans-serif; font-size: 0.875rem; font-weight: 600;
    color: white; transition: opacity 0.2s, transform 0.2s;
  }
  .nav-cta:hover { opacity: 0.9; transform: translateY(-1px); }

  /* Hero */
  #hero {
    position: relative; min-height: 100vh;
    display: flex; align-items: center;
    padding: 120px 60px 80px;
    overflow: hidden;
  }
  .hero-content { position: relative; z-index: 2; max-width: 700px; }
  .hero-tag {
    display: inline-flex; align-items: center; gap: 8px;
    padding: 6px 16px; border-radius: 100px;
    border: 1px solid rgba(124,58,237,0.4);
    background: rgba(124,58,237,0.08);
    font-size: 0.78rem; font-weight: 500; color: var(--purple-light);
    text-transform: uppercase; letter-spacing: 0.12em; margin-bottom: 28px;
  }
  .hero-tag span { width: 6px; height: 6px; background: var(--purple-light); border-radius: 50%; animation: pulse 2s infinite; }
  @keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:0.5;transform:scale(0.8)} }

  h1 {
    font-family: 'Space Grotesk', sans-serif;
    font-size: clamp(3rem, 6vw, 5.5rem);
    font-weight: 700; line-height: 1.08;
    letter-spacing: -0.03em; margin-bottom: 24px;
  }
  h1 .grad { background: var(--grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

  .hero-sub {
    font-size: 1.15rem; color: var(--muted); max-width: 520px;
    line-height: 1.7; margin-bottom: 44px; font-weight: 400;
  }
  .hero-actions { display: flex; gap: 16px; align-items: center; }
  .btn-primary {
    background: var(--grad); border: none; cursor: pointer;
    padding: 14px 32px; border-radius: 10px;
    font-family: 'Space Grotesk', sans-serif; font-size: 1rem; font-weight: 600;
    color: white; transition: all 0.25s; text-decoration: none; display: inline-block;
    box-shadow: 0 0 40px rgba(124,58,237,0.3);
  }
  .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 0 60px rgba(124,58,237,0.5); }
  .btn-ghost {
    background: none; border: 1px solid var(--border); cursor: pointer;
    padding: 14px 32px; border-radius: 10px;
    font-family: 'Space Grotesk', sans-serif; font-size: 1rem; font-weight: 500;
    color: var(--muted); transition: all 0.25s; text-decoration: none; display: inline-block;
  }
  .btn-ghost:hover { border-color: rgba(255,255,255,0.2); color: var(--text); }

  /* Hero canvas */
  #workflow-canvas {
    position: absolute; right: 0; top: 0;
    width: 55%; height: 100%;
    opacity: 0.85;
  }

  /* Gradient orbs */
  .orb {
    position: absolute; border-radius: 50%;
    filter: blur(80px); pointer-events: none; z-index: 1;
  }
  .orb-1 { width: 500px; height: 500px; background: rgba(124,58,237,0.15); top: -100px; right: 100px; }
  .orb-2 { width: 300px; height: 300px; background: rgba(6,182,212,0.1); bottom: 100px; right: 300px; }

  /* Sections */
  section { padding: 120px 60px; }

  .section-tag {
    display: inline-block; font-size: 0.75rem; font-weight: 600;
    text-transform: uppercase; letter-spacing: 0.15em;
    color: var(--cyan); margin-bottom: 16px;
  }
  h2 {
    font-family: 'Space Grotesk', sans-serif;
    font-size: clamp(2rem, 4vw, 3.5rem);
    font-weight: 700; line-height: 1.1; letter-spacing: -0.025em;
    margin-bottom: 20px;
  }
  .section-sub {
    font-size: 1.05rem; color: var(--muted); max-width: 540px; line-height: 1.7;
  }

  /* Services */
  #services { background: var(--bg2); }
  .services-header { margin-bottom: 72px; }
  .services-grid {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 0;
    border: 1px solid var(--border); border-radius: 16px; overflow: hidden;
  }
  .service-card {
    background: transparent; padding: 36px 32px;
    border-right: 1px solid var(--border);
    border-bottom: 1px solid var(--border);
    position: relative; overflow: hidden;
    transition: background 0.25s;
  }
  .service-card:nth-child(3n)  { border-right: none; }
  .service-card:nth-child(n+4) { border-bottom: none; }
  .service-card::after {
    content: ''; position: absolute; top: 0; left: 0; right: 0;
    height: 1.5px; background: var(--grad); opacity: 0; transition: opacity 0.3s;
  }
  .service-card:hover { background: rgba(255,255,255,0.018); }
  .service-card:hover::after { opacity: 1; }
  .sc-header {
    display: flex; align-items: flex-start; justify-content: space-between;
    margin-bottom: 28px;
  }
  .service-icon {
    width: 40px; height: 40px; border-radius: 10px;
    background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.09);
    display: flex; align-items: center; justify-content: center;
    color: rgba(255,255,255,0.62);
  }
  .sc-num {
    font-family: 'Space Grotesk', sans-serif; font-size: 0.7rem;
    font-weight: 500; color: rgba(100,116,139,0.4); letter-spacing: 0.06em;
    padding-top: 3px;
  }
  .service-card h3 {
    font-family: 'Space Grotesk', sans-serif; font-size: 1.05rem;
    font-weight: 600; margin-bottom: 10px; color: var(--text); letter-spacing: -0.01em;
  }
  .service-card p { font-size: 0.875rem; color: var(--muted); line-height: 1.65; }

  /* Workflow Section */
  #workflow { overflow: hidden; }
  .workflow-split {
    display: grid; grid-template-columns: 1fr 1.55fr;
    gap: 72px; align-items: center;
  }
  .workflow-text h2 { margin-bottom: 18px; }
  .workflow-text .section-sub { max-width: none; }
  .workflow-feats { margin-top: 36px; display: flex; flex-direction: column; gap: 16px; }
  .wfeat { display: flex; align-items: center; gap: 12px; font-size: 0.9rem; color: var(--muted); }
  .wfeat-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--cyan); flex-shrink: 0; }

  /* Macbook frame */
  .workflow-mac {
    border-radius: 14px; overflow: hidden;
    border: 2.5px solid rgba(255,255,255,0.22);
    box-shadow: 0 32px 90px rgba(0,0,0,0.75), 0 10px 28px rgba(0,0,0,0.55);
  }
  .mac-bar {
    height: 38px; background: #111122;
    border-bottom: 1px solid rgba(255,255,255,0.07);
    display: flex; align-items: center; padding: 0 14px; position: relative;
  }
  .mac-dots { display: flex; gap: 6px; }
  .mac-dot { width: 12px; height: 12px; border-radius: 50%; }
  .mac-dot.red { background: #ff5f57; }
  .mac-dot.yellow { background: #febc2e; }
  .mac-dot.green { background: #28c840; }
  .mac-title {
    position: absolute; left: 50%; transform: translateX(-50%);
    font-size: 0.74rem; color: var(--muted); font-weight: 500; letter-spacing: 0.04em;
  }
  #workflow-demo-canvas { width: 100%; height: 440px; display: block; background: var(--bg2); cursor: grab; touch-action: none; user-select: none; }
  #workflow-demo-canvas:active { cursor: grabbing; }

  @media (max-width: 1050px) {
    .workflow-split { grid-template-columns: 1fr; }
    .workflow-mac { display: none; }
  }

  /* Stats */
  #stats { background: var(--bg2); }
  .stats-grid {
    display: grid; grid-template-columns: repeat(4,1fr); gap: 2px;
    background: var(--border); border: 1px solid var(--border);
    border-radius: 16px; overflow: hidden;
  }
  .stat-card { background: var(--bg2); padding: 48px 36px; }
  .stat-num {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 3.2rem; font-weight: 700; letter-spacing: -0.04em;
    background: var(--grad); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    line-height: 1;
    margin-bottom: 10px;
  }
  .stat-label { font-size: 0.9rem; color: var(--muted); font-weight: 400; }

  /* Process */
  #process { }
  .process-header { margin-bottom: 80px; }
  .process-steps { display: flex; flex-direction: column; gap: 0; position: relative; }
  .process-steps::before {
    content: ''; position: absolute; left: 23px; top: 24px; bottom: 24px;
    width: 1px; background: linear-gradient(to bottom, var(--purple), transparent);
  }
  .step {
    display: flex; gap: 32px; padding: 36px 0;
    border-bottom: 1px solid var(--border); align-items: flex-start;
    opacity: 0; transform: translateX(-20px);
  }
  .step-num {
    min-width: 48px; height: 48px; border-radius: 50%;
    background: rgba(124,58,237,0.12); border: 1px solid rgba(124,58,237,0.3);
    display: flex; align-items: center; justify-content: center;
    font-family: 'Space Grotesk', sans-serif; font-size: 0.85rem;
    font-weight: 700; color: var(--purple-light); position: relative; z-index: 1;
  }
  .step-content h3 {
    font-family: 'Space Grotesk', sans-serif; font-size: 1.15rem;
    font-weight: 600; margin-bottom: 8px; letter-spacing: -0.01em;
  }
  .step-content p { font-size: 0.9rem; color: var(--muted); line-height: 1.65; max-width: 600px; }

  /* CTA */
  #cta {
    background: var(--bg2);
    text-align: center; padding: 140px 60px;
  }
  .cta-inner {
    max-width: 700px; margin: 0 auto;
    position: relative;
  }
  .cta-glow {
    position: absolute; width: 600px; height: 300px; border-radius: 50%;
    background: radial-gradient(ellipse, rgba(124,58,237,0.15), transparent 70%);
    top: 50%; left: 50%; transform: translate(-50%,-50%);
    pointer-events: none;
  }
  #cta h2 { margin-bottom: 20px; }
  #cta .section-sub { margin: 0 auto 44px; }
  .cta-form {
    display: flex; gap: 12px; max-width: 480px; margin: 0 auto;
  }
  .cta-input {
    flex: 1; background: rgba(255,255,255,0.05);
    border: 1px solid var(--border); border-radius: 10px;
    padding: 14px 18px; font-family: 'Inter', sans-serif; font-size: 0.95rem;
    color: var(--text); outline: none; transition: border-color 0.2s;
  }
  .cta-input:focus { border-color: rgba(124,58,237,0.5); }
  .cta-input::placeholder { color: var(--muted); }

  /* Footer */
  footer {
    padding: 40px 60px;
    border-top: 1px solid var(--border);
    display: flex; align-items: center; justify-content: space-between;
    flex-wrap: wrap; gap: 20px;
  }
  footer .nav-logo { font-size: 1.1rem; }
  footer p { font-size: 0.82rem; color: var(--muted); }
  .footer-links { display: flex; gap: 28px; }
  .footer-links a { font-size: 0.82rem; color: var(--muted); text-decoration: none; transition: color 0.2s; }
  .footer-links a:hover { color: var(--text); }

  /* Parallax layers */
  .parallax-layer { will-change: transform; }

  /* Fade-in utility */
  .fade-up { opacity: 0; transform: translateY(30px); }

  @media (max-width: 900px) {
    nav { padding: 16px 24px; }
    nav .nav-links { display: none; }
    section { padding: 80px 24px; }
    #hero { padding: 100px 24px 60px; }
    #workflow-canvas { display: none; }
    .services-grid { grid-template-columns: 1fr; }
    .stats-grid { grid-template-columns: repeat(2,1fr); }
    footer { padding: 32px 24px; flex-direction: column; text-align: center; }
  }
</style>
</head>
<body>

<!-- NAV -->
<nav id="navbar">
  <div class="nav-logo">samplern</div>
  <ul class="nav-links">
    <li><a href="#services">Services</a></li>
    <li><a href="#workflow">Workflows</a></li>
    <li><a href="#process">Process</a></li>
    <li><a href="#cta">Contact</a></li>
  </ul>
  <button class="nav-cta" onclick="document.getElementById('cta').scrollIntoView({behavior:'smooth'})">Book a Call</button>
</nav>

<!-- HERO -->
<section id="hero">
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="hero-content">
    <div class="hero-tag"><span></span> Enterprise Automation</div>
    <h1>Automate Your<br/>Business with<br/><span class="grad">n8n Workflows</span></h1>
    <p class="hero-sub">We design, build, and deploy intelligent automation pipelines that eliminate repetitive work, connect your tools, and scale your operations.</p>
    <div class="hero-actions">
      <a href="#cta" class="btn-primary">Start Automating</a>
      <a href="#workflow" class="btn-ghost">See How It Works</a>
    </div>
  </div>
  <canvas id="workflow-canvas"></canvas>
</section>

<!-- SERVICES -->
<section id="services">
  <div class="services-header">
    <div class="section-tag">What We Build</div>
    <h2>Automation for<br/>Every Business Layer</h2>
  </div>
  <div class="services-grid">
    <div class="service-card fade-up">
      <div class="sc-header">
        <div class="service-icon">
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M2 3h14l-5.5 7v4.5l-3-1.5V10L2 3z"/></svg>
        </div>
        <span class="sc-num">01</span>
      </div>
      <h3>Lead Generation</h3>
      <p>Automated pipelines that capture, score, and route leads from every source into your CRM without manual input.</p>
    </div>
    <div class="service-card fade-up">
      <div class="sc-header">
        <div class="service-icon">
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><path d="M7.5 10.5a4 4 0 005.656 0l2-2a4 4 0 00-5.656-5.656L8.086 4.258"/><path d="M10.5 7.5a4 4 0 00-5.656 0l-2 2a4 4 0 005.656 5.656L9.914 13.742"/></svg>
        </div>
        <span class="sc-num">02</span>
      </div>
      <h3>API Integrations</h3>
      <p>Connect any two tools your business uses ‚Äî Slack, HubSpot, Notion, Airtable, Shopify, and hundreds more.</p>
    </div>
    <div class="service-card fade-up">
      <div class="sc-header">
        <div class="service-icon">
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 1l1.5 5.5L16 8l-5.5 1.5L9 15l-1.5-5.5L2 8l5.5-1.5L9 1z"/></svg>
        </div>
        <span class="sc-num">03</span>
      </div>
      <h3>AI-Powered Flows</h3>
      <p>Embed GPT-4 and Claude into your workflows for intelligent data processing, classification, and content generation.</p>
    </div>
    <div class="service-card fade-up">
      <div class="sc-header">
        <div class="service-icon">
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><rect x="2" y="10" width="3.5" height="6" rx="1"/><rect x="7.25" y="6" width="3.5" height="10" rx="1"/><rect x="12.5" y="2" width="3.5" height="14" rx="1"/></svg>
        </div>
        <span class="sc-num">04</span>
      </div>
      <h3>Reporting & Alerts</h3>
      <p>Automated dashboards, Slack alerts, and email digests that keep your team informed without lifting a finger.</p>
    </div>
    <div class="service-card fade-up">
      <div class="sc-header">
        <div class="service-icon">
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 5h12l-1.5 9H4.5L3 5z"/><path d="M6 5V4a3 3 0 016 0v1"/></svg>
        </div>
        <span class="sc-num">05</span>
      </div>
      <h3>E-Commerce Ops</h3>
      <p>Order processing, inventory sync, customer follow-ups, and fulfillment automation built for scale.</p>
    </div>
    <div class="service-card fade-up">
      <div class="sc-header">
        <div class="service-icon">
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"><rect x="2" y="2" width="6" height="6" rx="1.5"/><rect x="10" y="2" width="6" height="6" rx="1.5"/><rect x="2" y="10" width="6" height="6" rx="1.5"/><rect x="10" y="10" width="6" height="6" rx="1.5"/></svg>
        </div>
        <span class="sc-num">06</span>
      </div>
      <h3>Internal Tools</h3>
      <p>Custom internal automation for HR onboarding, finance approvals, and ops workflows unique to your team.</p>
    </div>
  </div>
</section>

<!-- WORKFLOW DEMO -->
<section id="workflow">
  <div class="workflow-split">
    <div class="workflow-text">
      <div class="section-tag">n8n Automation</div>
      <h2>Tell us what you want to automate</h2>
      <p class="section-sub">We create custom n8n workflows that run 24/7 to eliminate manual work, connect your tools, and scale your operations automatically.</p>
      <div class="workflow-feats">
        <div class="wfeat"><div class="wfeat-dot"></div>CRM &amp; lead pipeline automation</div>
        <div class="wfeat"><div class="wfeat-dot"></div>AI-powered data enrichment flows</div>
        <div class="wfeat"><div class="wfeat-dot"></div>Slack, email &amp; webhook integrations</div>
        <div class="wfeat"><div class="wfeat-dot"></div>Conditional logic &amp; branching pipelines</div>
      </div>
    </div>
    <div class="workflow-mac">
      <div class="mac-bar">
        <div class="mac-dots">
          <span class="mac-dot red"></span>
          <span class="mac-dot yellow"></span>
          <span class="mac-dot green"></span>
        </div>
        <span class="mac-title">Workflow</span>
      </div>
      <canvas id="workflow-demo-canvas"></canvas>
    </div>
  </div>
</section>

<!-- STATS -->
<section id="stats">
  <div class="stats-grid">
    <div class="stat-card fade-up">
      <div class="stat-num" data-target="120">0</div>
      <div class="stat-label">Workflows Deployed</div>
    </div>
    <div class="stat-card fade-up">
      <div class="stat-num" data-target="98">0</div>
      <div class="stat-label">% Client Retention</div>
    </div>
    <div class="stat-card fade-up">
      <div class="stat-num" data-target="40">0</div>
      <div class="stat-label">Avg Hours Saved/Week</div>
    </div>
    <div class="stat-card fade-up">
      <div class="stat-num" data-target="3">0</div>
      <div class="stat-label">Day Avg Delivery</div>
    </div>
  </div>
</section>

<!-- PROCESS -->
<section id="process">
  <div class="process-header">
    <div class="section-tag">How It Works</div>
    <h2>From Idea to<br/>Running Automation</h2>
  </div>
  <div class="process-steps">
    <div class="step">
      <div class="step-num">01</div>
      <div class="step-content">
        <h3>Discovery Call</h3>
        <p>We map your current tools, processes, and pain points. You walk us through what's eating your team's time and we identify the highest-leverage automation opportunities.</p>
      </div>
    </div>
    <div class="step">
      <div class="step-num">02</div>
      <div class="step-content">
        <h3>Workflow Architecture</h3>
        <p>Our engineers design a complete node map of your automation ‚Äî every trigger, condition, transformation, and output is planned before a single connection is made.</p>
      </div>
    </div>
    <div class="step">
      <div class="step-num">03</div>
      <div class="step-content">
        <h3>Build & Test</h3>
        <p>We build the workflow in your n8n instance (cloud or self-hosted), run edge-case testing, and set up error handling so nothing breaks in production.</p>
      </div>
    </div>
    <div class="step">
      <div class="step-num">04</div>
      <div class="step-content">
        <h3>Deploy & Handoff</h3>
        <p>Your workflow goes live. We document everything, walk your team through it, and remain on-call for the first 30 days to handle any edge cases.</p>
      </div>
    </div>
  </div>
</section>

<!-- CTA -->
<section id="cta">
  <div class="cta-inner">
    <div class="cta-glow"></div>
    <div class="section-tag">Get Started</div>
    <h2>Ready to Automate?</h2>
    <p class="section-sub">Tell us what you want to automate and we'll scope a workflow for you ‚Äî free, no commitment.</p>
    <div class="cta-form">
      <input class="cta-input" type="email" placeholder="your@company.com"/>
      <button class="btn-primary">Let's Talk</button>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer>
  <div class="nav-logo">samplern</div>
  <p>¬© 2026 Samplern. All rights reserved.</p>
  <div class="footer-links">
    <a href="#">Twitter</a>
    <a href="#">LinkedIn</a>
    <a href="#">Privacy</a>
  </div>
</footer>

<script>
gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);

/* ‚îÄ‚îÄ NAV scroll effect ‚îÄ‚îÄ */
ScrollTrigger.create({
  start: 'top -60',
  onUpdate: self => {
    document.getElementById('navbar').style.background =
      self.progress > 0 ? 'rgba(7,7,15,0.95)' : 'rgba(7,7,15,0.8)';
  }
});

/* ‚îÄ‚îÄ HERO canvas ‚Äì n8n-style workflow ‚îÄ‚îÄ */
(function() {
  const canvas = document.getElementById('workflow-canvas');
  const ctx = canvas.getContext('2d');
  let W, H, NW, NH, animId;

  /* Nodes ‚Äî each has icon panel + label + type + items count */
  const nodes = [
    { id:'webhook', label:'Webhook',  icon:'‚ö°', color:'#7c3aed', x:0.13, y:0.40, type:'Trigger',   items:1  },
    { id:'filter',  label:'Filter',   icon:'üîç', color:'#06b6d4', x:0.39, y:0.22, type:'Transform', items:1  },
    { id:'ai',      label:'GPT-4',    icon:'ü§ñ', color:'#f59e0b', x:0.39, y:0.62, type:'AI ¬∑ LLM',  items:1  },
    { id:'crm',     label:'HubSpot',  icon:'üìã', color:'#10b981', x:0.66, y:0.22, type:'CRM',       items:3  },
    { id:'slack',   label:'Slack',    icon:'üí¨', color:'#06b6d4', x:0.66, y:0.55, type:'Messenger', items:3  },
    { id:'email',   label:'Email',    icon:'‚úâÔ∏è', color:'#10b981', x:0.66, y:0.82, type:'Notify',    items:3  },
    { id:'end',     label:'Done',     icon:'‚úÖ', color:'#7c3aed', x:0.90, y:0.40, type:'End Node',  items:7  },
  ];
  const edges = [
    ['webhook','filter'], ['webhook','ai'],
    ['filter','crm'], ['ai','slack'], ['ai','email'],
    ['crm','end'], ['slack','end'], ['email','end']
  ];

  function resize() {
    W = canvas.width  = canvas.offsetWidth;
    H = canvas.height = canvas.offsetHeight;
    /* scale node size so 4 columns always fit without overlap */
    NW = Math.min(152, Math.round(W * 0.21));
    NH = Math.round(NW * 0.52);
  }

  function npos(n)  { return { x: n.x * W,         y: n.y * H }; }
  function rport(n) { return { x: n.x * W + NW / 2, y: n.y * H }; }
  function lport(n) { return { x: n.x * W - NW / 2, y: n.y * H }; }

  /* ‚îÄ‚îÄ dot grid ‚îÄ‚îÄ */
  function drawDots() {
    ctx.fillStyle = 'rgba(255,255,255,0.045)';
    const sp = 26;
    for (let x = 0; x < W; x += sp)
      for (let y = 0; y < H; y += sp) {
        ctx.beginPath(); ctx.arc(x, y, 1.1, 0, Math.PI * 2); ctx.fill();
      }
  }

  function cubicB(p0, p1, p2, p3, t) {
    const u = 1 - t;
    return u*u*u*p0 + 3*u*u*t*p1 + 3*u*t*t*p2 + t*t*t*p3;
  }

  /* ‚îÄ‚îÄ glowing bezier wire with packet ‚îÄ‚îÄ */
  function drawEdge(a, b, tOff) {
    const pa = rport(a), pb = lport(b);
    const dx = Math.abs(pb.x - pa.x) * 0.55;
    const cp1x = pa.x + dx, cp1y = pa.y;
    const cp2x = pb.x - dx, cp2y = pb.y;

    const grad = ctx.createLinearGradient(pa.x, pa.y, pb.x, pb.y);
    grad.addColorStop(0,   a.color + 'ee');
    grad.addColorStop(0.5, a.color + '66');
    grad.addColorStop(1,   b.color + 'ee');

    /* glow pass */
    ctx.save();
    ctx.shadowColor = a.color; ctx.shadowBlur = 14;
    ctx.beginPath(); ctx.moveTo(pa.x, pa.y);
    ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, pb.x, pb.y);
    ctx.strokeStyle = grad; ctx.lineWidth = 2.5; ctx.stroke();
    ctx.restore();

    /* crisp line */
    ctx.beginPath(); ctx.moveTo(pa.x, pa.y);
    ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, pb.x, pb.y);
    ctx.strokeStyle = grad; ctx.lineWidth = 1.5; ctx.stroke();

    /* arrowhead */
    const nx = cubicB(pa.x, cp1x, cp2x, pb.x, 0.97);
    const ny = cubicB(pa.y, cp1y, cp2y, pb.y, 0.97);
    const ang = Math.atan2(pb.y - ny, pb.x - nx);
    ctx.save();
    ctx.translate(pb.x, pb.y); ctx.rotate(ang);
    ctx.fillStyle = b.color + 'ee';
    ctx.beginPath(); ctx.moveTo(0,0); ctx.lineTo(-9,-4.5); ctx.lineTo(-9,4.5);
    ctx.closePath(); ctx.fill();
    ctx.restore();

    /* animated data packet */
    const s  = tOff % 1;
    const bx = cubicB(pa.x, cp1x, cp2x, pb.x, s);
    const by = cubicB(pa.y, cp1y, cp2y, pb.y, s);
    const pg = ctx.createRadialGradient(bx, by, 0, bx, by, 10);
    pg.addColorStop(0,    '#ffffff');
    pg.addColorStop(0.3,  a.color);
    pg.addColorStop(1,    'transparent');
    ctx.beginPath(); ctx.arc(bx, by, 7, 0, Math.PI * 2);
    ctx.fillStyle = pg; ctx.fill();
  }

  /* ‚îÄ‚îÄ rounded rect path ‚îÄ‚îÄ */
  function rrect(x, y, w, h, r) {
    ctx.beginPath();
    ctx.moveTo(x+r, y);
    ctx.lineTo(x+w-r, y); ctx.quadraticCurveTo(x+w, y, x+w, y+r);
    ctx.lineTo(x+w, y+h-r); ctx.quadraticCurveTo(x+w, y+h, x+w-r, y+h);
    ctx.lineTo(x+r, y+h); ctx.quadraticCurveTo(x, y+h, x, y+h-r);
    ctx.lineTo(x, y+r);   ctx.quadraticCurveTo(x, y, x+r, y);
    ctx.closePath();
  }

  /* ‚îÄ‚îÄ full n8n-style node ‚îÄ‚îÄ */
  function drawNode(n, t) {
    const {x, y} = npos(n);
    const w = NW, h = NH;
    const r  = Math.round(h * 0.15);
    const lx = x - w / 2, ty = y - h / 2;

    /* derived sizes ‚Äî all proportional so they scale with NW/NH */
    const iconPanelW = Math.round(w * 0.33);   /* left colored panel */
    const iconCx     = lx + iconPanelW / 2;
    const iconR      = Math.round(h * 0.23);
    const metaH      = Math.round(h * 0.32);   /* bottom meta strip height */
    const nameY      = ty + Math.round((h - metaH) * 0.46);
    const typeY      = ty + Math.round((h - metaH) * 0.76);
    const metaY      = ty + h - Math.round(metaH * 0.42);
    const tx         = lx + iconPanelW + Math.round(w * 0.06);
    const nameSize   = Math.max(9,  Math.round(h * 0.185));
    const typeSize   = Math.max(7,  Math.round(h * 0.125));
    const metaSize   = Math.max(6.5,Math.round(h * 0.115));

    /* ‚îÄ‚îÄ 1. outer glow + card bg ‚îÄ‚îÄ */
    ctx.shadowColor = n.color; ctx.shadowBlur = 32;
    ctx.fillStyle = '#0b0b1d';
    rrect(lx, ty, w, h, r); ctx.fill();
    ctx.shadowBlur = 0;

    /* ‚îÄ‚îÄ 2. card border ‚îÄ‚îÄ */
    ctx.strokeStyle = n.color + 'cc'; ctx.lineWidth = 1.5;
    rrect(lx, ty, w, h, r); ctx.stroke();

    /* ‚îÄ‚îÄ 3. clipped interior layers ‚îÄ‚îÄ */
    ctx.save();
    rrect(lx, ty, w, h, r); ctx.clip();

    /* icon panel colored bg */
    const ipGrad = ctx.createLinearGradient(lx, 0, lx + iconPanelW, 0);
    ipGrad.addColorStop(0, n.color + '45');
    ipGrad.addColorStop(1, n.color + '18');
    ctx.fillStyle = ipGrad;
    ctx.fillRect(lx, ty, iconPanelW, h);

    /* icon panel right divider */
    ctx.strokeStyle = n.color + '44'; ctx.lineWidth = 1;
    ctx.beginPath();
    ctx.moveTo(lx + iconPanelW, ty + 5);
    ctx.lineTo(lx + iconPanelW, ty + h - 5);
    ctx.stroke();

    /* top accent strip */
    const topG = ctx.createLinearGradient(lx, ty, lx + w, ty);
    topG.addColorStop(0,   n.color + 'cc');
    topG.addColorStop(0.4, n.color + '44');
    topG.addColorStop(1,   'transparent');
    ctx.fillStyle = topG;
    ctx.fillRect(lx, ty, w, 2.5);

    /* bottom meta bar */
    const metaBg = ctx.createLinearGradient(lx, ty + h - metaH, lx, ty + h);
    metaBg.addColorStop(0, 'rgba(0,0,0,0)');
    metaBg.addColorStop(1, 'rgba(0,0,0,0.35)');
    ctx.fillStyle = metaBg;
    ctx.fillRect(lx + iconPanelW, ty + h - metaH, w - iconPanelW, metaH);

    /* meta bar top separator */
    ctx.strokeStyle = n.color + '28'; ctx.lineWidth = 0.75;
    ctx.beginPath();
    ctx.moveTo(lx + iconPanelW, ty + h - metaH);
    ctx.lineTo(lx + w,          ty + h - metaH);
    ctx.stroke();

    ctx.restore(); /* end clip */

    /* ‚îÄ‚îÄ 4. icon circle with pulsing ring ‚îÄ‚îÄ */
    ctx.fillStyle = n.color + '30';
    ctx.beginPath(); ctx.arc(iconCx, y, iconR, 0, Math.PI * 2); ctx.fill();
    ctx.strokeStyle = n.color + '99'; ctx.lineWidth = 1.5;
    ctx.stroke();

    /* outer pulsing ring */
    const pulse = 0.4 + 0.6 * Math.abs(Math.sin(t * 2.2 + n.x * 8));
    const pHex  = Math.round(pulse * 0x55).toString(16).padStart(2, '0');
    ctx.strokeStyle = n.color + pHex; ctx.lineWidth = 1;
    ctx.beginPath(); ctx.arc(iconCx, y, iconR + 5, 0, Math.PI * 2); ctx.stroke();

    /* icon emoji */
    ctx.font = `${Math.round(iconR * 1.15)}px serif`;
    ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
    ctx.fillStyle = '#fff';
    ctx.fillText(n.icon, iconCx, y + 1);

    /* ‚îÄ‚îÄ 5. node label ‚îÄ‚îÄ */
    ctx.fillStyle = '#f1f5f9';
    ctx.font = `700 ${nameSize}px Inter`;
    ctx.textAlign = 'left'; ctx.textBaseline = 'middle';
    ctx.fillText(n.label, tx, nameY);

    /* ‚îÄ‚îÄ 6. node type tag ‚îÄ‚îÄ */
    ctx.fillStyle = n.color + 'cc';
    ctx.font = `500 ${typeSize}px Inter`;
    ctx.fillText(n.type, tx, typeY);

    /* ‚îÄ‚îÄ 7. meta bar: items count + live pulse dot ‚îÄ‚îÄ */
    const itemLabel = `${n.items} item${n.items > 1 ? 's' : ''}`;
    ctx.fillStyle = 'rgba(148,163,184,0.7)';
    ctx.font = `400 ${metaSize}px Inter`;
    ctx.fillText(itemLabel, tx, metaY);

    /* live status dot */
    const dotX    = lx + w - Math.round(w * 0.1);
    const dotPulse= 0.55 + 0.45 * Math.sin(t * 3.5 + n.x * 5);
    ctx.fillStyle = `rgba(16,185,129,${dotPulse.toFixed(2)})`;
    ctx.shadowColor = '#10b981'; ctx.shadowBlur = 9;
    ctx.beginPath(); ctx.arc(dotX, metaY, 3.5, 0, Math.PI * 2); ctx.fill();
    ctx.shadowBlur = 0;

    /* execution badge (top-right corner) */
    const bdX = lx + w - Math.round(w * 0.1);
    const bdY = ty + Math.round(h * 0.2);
    ctx.fillStyle = '#10b981';
    ctx.shadowColor = '#10b981'; ctx.shadowBlur = 7;
    ctx.beginPath(); ctx.arc(bdX, bdY, 3, 0, Math.PI * 2); ctx.fill();
    ctx.shadowBlur = 0;

    /* ‚îÄ‚îÄ 8. connection ports ‚îÄ‚îÄ */
    const portR = Math.round(h * 0.095);
    /* right output port */
    ctx.fillStyle = '#0b0b1d';
    ctx.shadowColor = n.color; ctx.shadowBlur = 14;
    ctx.beginPath(); ctx.arc(x + w/2, y, portR + 2.5, 0, Math.PI * 2); ctx.fill();
    ctx.shadowBlur = 0;
    ctx.fillStyle = n.color;
    ctx.beginPath(); ctx.arc(x + w/2, y, portR, 0, Math.PI * 2); ctx.fill();
    ctx.strokeStyle = '#0b0b1d'; ctx.lineWidth = 1.5; ctx.stroke();
    /* inner dot */
    ctx.fillStyle = '#fff';
    ctx.beginPath(); ctx.arc(x + w/2, y, portR * 0.4, 0, Math.PI * 2); ctx.fill();

    /* left input port */
    ctx.fillStyle = '#0b0b1d';
    ctx.beginPath(); ctx.arc(lx, y, portR + 1.5, 0, Math.PI * 2); ctx.fill();
    ctx.strokeStyle = n.color + 'aa'; ctx.lineWidth = 1.5;
    ctx.beginPath(); ctx.arc(lx, y, portR, 0, Math.PI * 2); ctx.fill();
    ctx.stroke();
  }

  let t = 0;
  function animate() {
    ctx.clearRect(0, 0, W, H);
    drawDots();
    t += 0.004;
    const nm = {};
    nodes.forEach(n => nm[n.id] = n);
    edges.forEach(([a, b], i) => drawEdge(nm[a], nm[b], t + i * 0.13));
    nodes.forEach(n => drawNode(n, t));
    animId = requestAnimationFrame(animate);
  }

  const observer = new IntersectionObserver(entries => {
    if (entries[0].isIntersecting) { resize(); animate(); }
    else { cancelAnimationFrame(animId); }
  });
  observer.observe(canvas);
  window.addEventListener('resize', resize);
})();


/* ‚îÄ‚îÄ WORKFLOW DEMO canvas ‚Äì pannable n8n editor ‚îÄ‚îÄ */
(function() {
  const canvas = document.getElementById('workflow-demo-canvas');
  const ctx    = canvas.getContext('2d');
  let W, H, animId2, t2 = 0;

  /* fixed world-space node dimensions */
  const NW = 224, NH = 152;

  /* world-space positions (pixels, center of node) */
  const nodes = [
    { id:'trigger',   title:'HTTP Trigger',      type:'Webhook',        color:'#7c3aed', wx:0,   wy:0,    preview:'trigger', status:'Active'    },
    { id:'leads',     title:'Find Startup Leads', type:'Search Contacts', color:'#3b82f6', wx:300, wy:-108, preview:'table',   status:'Completed' },
    { id:'condition', title:'Check Lead Count',   type:'Conditional',    color:'#f59e0b', wx:300, wy:108,  preview:'if',      status:'Completed' },
    { id:'crm',       title:'Push to HubSpot',    type:'CRM Integration', color:'#10b981', wx:600, wy:-108, preview:'crm',    status:'Completed' },
    { id:'slack',     title:'Notify via Slack',   type:'Messenger',      color:'#3b82f6', wx:600, wy:108,  preview:'slack',   status:'Completed' },
    { id:'done',      title:'Workflow Complete',  type:'End Node',       color:'#7c3aed', wx:900, wy:0,    preview:'done',    status:'Success'   },
  ];
  const edges = [
    ['trigger','leads'],['trigger','condition'],
    ['leads','crm'],['condition','slack'],
    ['crm','done'],['slack','done']
  ];

  /* pan state */
  let panX = 0, panY = 0, velX = 0, velY = 0;
  let isDragging = false, lastMX = 0, lastMY = 0;
  let panInitialized = false;

  function resize() {
    W = canvas.width  = canvas.offsetWidth;
    H = canvas.height = canvas.offsetHeight;
    if (!panInitialized) {
      panX = NW / 2 + 36;   /* show trigger with 36px left margin */
      panY = H / 2;
      panInitialized = true;
    }
  }

  /* canvas-space positions */
  function cx(n)    { return n.wx + panX; }
  function cy(n)    { return n.wy + panY; }
  function rport(n) { return { x: n.wx + panX + NW/2, y: n.wy + panY }; }
  function lport(n) { return { x: n.wx + panX - NW/2, y: n.wy + panY }; }

  /* ‚îÄ‚îÄ drag / pan interaction ‚îÄ‚îÄ */
  canvas.addEventListener('mousedown', e => {
    isDragging = true; velX = velY = 0;
    lastMX = e.clientX; lastMY = e.clientY;
  });
  canvas.addEventListener('mousemove', e => {
    if (!isDragging) return;
    const dx = e.clientX - lastMX, dy = e.clientY - lastMY;
    panX += dx; panY += dy; velX = dx; velY = dy;
    lastMX = e.clientX; lastMY = e.clientY;
  });
  const endDrag = () => { isDragging = false; };
  canvas.addEventListener('mouseup', endDrag);
  canvas.addEventListener('mouseleave', endDrag);
  /* touch */
  let ltx = 0, lty = 0;
  canvas.addEventListener('touchstart', e => { e.preventDefault(); velX=velY=0; ltx=e.touches[0].clientX; lty=e.touches[0].clientY; }, {passive:false});
  canvas.addEventListener('touchmove',  e => { e.preventDefault(); const dx=e.touches[0].clientX-ltx, dy=e.touches[0].clientY-lty; panX+=dx; panY+=dy; velX=dx; velY=dy; ltx=e.touches[0].clientX; lty=e.touches[0].clientY; }, {passive:false});

  /* ‚îÄ‚îÄ dot grid (infinite canvas feel) ‚îÄ‚îÄ */
  function drawDots() {
    ctx.fillStyle = 'rgba(255,255,255,0.038)';
    const sp = 22;
    const ox = ((panX % sp) + sp) % sp, oy = ((panY % sp) + sp) % sp;
    for (let x = ox - sp; x < W + sp; x += sp)
      for (let y = oy - sp; y < H + sp; y += sp) {
        ctx.beginPath(); ctx.arc(x, y, 1.2, 0, Math.PI*2); ctx.fill();
      }
  }

  function cubicB(p0,p1,p2,p3,t){ const u=1-t; return u*u*u*p0+3*u*u*t*p1+3*u*t*t*p2+t*t*t*p3; }

  /* ‚îÄ‚îÄ clean professional wire ‚îÄ‚îÄ */
  function drawEdge(a, b, idx) {
    const pa = rport(a), pb = lport(b);
    const dx = Math.abs(pb.x - pa.x) * 0.52;
    const cp1x=pa.x+dx, cp1y=pa.y, cp2x=pb.x-dx, cp2y=pb.y;
    /* single neutral wire ‚Äî no rainbow */
    ctx.beginPath(); ctx.moveTo(pa.x,pa.y);
    ctx.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,pb.x,pb.y);
    ctx.strokeStyle='rgba(255,255,255,0.18)'; ctx.lineWidth=1.5; ctx.stroke();
    /* small neutral arrowhead */
    const nx=cubicB(pa.x,cp1x,cp2x,pb.x,0.97), ny=cubicB(pa.y,cp1y,cp2y,pb.y,0.97);
    const ang=Math.atan2(pb.y-ny,pb.x-nx);
    ctx.save(); ctx.translate(pb.x,pb.y); ctx.rotate(ang);
    ctx.fillStyle='rgba(255,255,255,0.35)';
    ctx.beginPath(); ctx.moveTo(0,0); ctx.lineTo(-7,-3.5); ctx.lineTo(-7,3.5); ctx.closePath(); ctx.fill();
    ctx.restore();
    /* small white traveling dot ‚Äî subtle, no glow */
    const s=(t2*0.38+idx*0.22)%1;
    const bx=cubicB(pa.x,cp1x,cp2x,pb.x,s), by=cubicB(pa.y,cp1y,cp2y,pb.y,s);
    ctx.fillStyle='rgba(255,255,255,0.75)';
    ctx.beginPath(); ctx.arc(bx,by,2.5,0,Math.PI*2); ctx.fill();
  }

  function rrect(x,y,w,h,r){
    ctx.beginPath(); ctx.moveTo(x+r,y);
    ctx.lineTo(x+w-r,y); ctx.quadraticCurveTo(x+w,y,x+w,y+r);
    ctx.lineTo(x+w,y+h-r); ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h);
    ctx.lineTo(x+r,y+h); ctx.quadraticCurveTo(x,y+h,x,y+h-r);
    ctx.lineTo(x,y+r); ctx.quadraticCurveTo(x,y,x+r,y); ctx.closePath();
  }

  /* ‚îÄ‚îÄ content preview renderers ‚îÄ‚îÄ */
  function drawTrigger(lx,ty,w,h){
    const pad=14,fx=lx+pad,fs=Math.max(8,Math.round(h*0.135));
    const bw=44,bh=20,by=ty+Math.round(h*0.12);
    ctx.fillStyle='rgba(124,58,237,0.18)'; rrect(fx,by,bw,bh,3); ctx.fill();
    ctx.strokeStyle='rgba(124,58,237,0.4)'; ctx.lineWidth=0.75; rrect(fx,by,bw,bh,3); ctx.stroke();
    ctx.fillStyle='rgba(167,139,250,0.9)'; ctx.font=`700 ${Math.max(7,Math.round(bh*0.52))}px Inter`;
    ctx.textAlign='center'; ctx.textBaseline='middle'; ctx.fillText('POST',fx+bw/2,by+bh/2);
    ctx.fillStyle='rgba(148,163,184,0.5)'; ctx.font=`400 ${fs}px Inter`;
    ctx.textAlign='left'; ctx.fillText('/webhook/trigger',fx+bw+8,by+bh/2);
    ctx.strokeStyle='rgba(255,255,255,0.05)'; ctx.lineWidth=0.5;
    ctx.beginPath(); ctx.moveTo(lx+6,ty+h*0.56); ctx.lineTo(lx+w-6,ty+h*0.56); ctx.stroke();
    const sy=ty+h*0.76;
    ctx.fillStyle='#22c55e'; ctx.beginPath(); ctx.arc(fx+4,sy,3,0,Math.PI*2); ctx.fill();
    ctx.fillStyle='rgba(148,163,184,0.5)'; ctx.font=`400 ${fs}px Inter`;
    ctx.fillText('Live ¬∑ awaiting requests',fx+13,sy);
  }
  function drawTable(lx,ty,w,h){
    const rows=[['John Doe','Acme Inc','CEO'],['Sarah M.','TechCorp','CTO'],['Mike Jo.','StartupX','VP Sales']];
    const hdrH=Math.round(h*0.26),rowH=Math.round((h-hdrH)/3.1),fs=Math.max(7,Math.round(h*0.12)),pad=12;
    const colX=[0,0.36,0.67];
    ctx.fillStyle='rgba(255,255,255,0.04)'; ctx.fillRect(lx,ty,w,hdrH);
    ['NAME','COMPANY','TITLE'].forEach((l,i)=>{
      ctx.fillStyle='rgba(100,116,139,0.8)'; ctx.font=`600 ${fs}px Inter`;
      ctx.textAlign='left'; ctx.textBaseline='middle'; ctx.fillText(l,lx+colX[i]*w+pad,ty+hdrH/2);
    });
    ctx.strokeStyle='rgba(255,255,255,0.06)'; ctx.lineWidth=0.5;
    ctx.beginPath(); ctx.moveTo(lx,ty+hdrH); ctx.lineTo(lx+w,ty+hdrH); ctx.stroke();
    rows.forEach((row,ri)=>{
      const ry=ty+hdrH+ri*rowH;
      if(ri%2===0){ctx.fillStyle='rgba(255,255,255,0.013)'; ctx.fillRect(lx,ry,w,rowH);}
      row.forEach((cell,ci)=>{
        ctx.fillStyle=ci===0?'rgba(241,245,249,0.82)':'rgba(148,163,184,0.58)';
        ctx.font=`400 ${fs}px Inter`; ctx.textAlign='left'; ctx.textBaseline='middle';
        ctx.fillText(cell,lx+colX[ci]*w+pad+2,ry+rowH/2);
      });
      ctx.strokeStyle='rgba(255,255,255,0.035)'; ctx.lineWidth=0.5;
      ctx.beginPath(); ctx.moveTo(lx,ry+rowH); ctx.lineTo(lx+w,ry+rowH); ctx.stroke();
    });
  }
  function drawIF(lx,ty,w,h){
    const cx2=lx+w/2,fs=Math.max(8,Math.round(h*0.135));
    const boxW=Math.round(w*0.6),boxH=Math.round(h*0.37),bx=cx2-boxW/2,by=ty+Math.round(h*0.06);
    ctx.fillStyle='rgba(245,158,11,0.07)'; rrect(bx,by,boxW,boxH,6); ctx.fill();
    ctx.strokeStyle='rgba(245,158,11,0.28)'; ctx.lineWidth=0.75; rrect(bx,by,boxW,boxH,6); ctx.stroke();
    ctx.fillStyle='rgba(241,245,249,0.5)'; ctx.font=`400 ${fs}px Inter`;
    ctx.textAlign='center'; ctx.textBaseline='middle'; ctx.fillText('if contacts',cx2,by+boxH*0.35);
    ctx.fillStyle='rgba(251,191,36,0.88)'; ctx.font=`700 ${Math.round(fs*1.15)}px Inter`;
    ctx.fillText('> 10',cx2,by+boxH*0.74);
    const ly0=by+boxH,ly1=ty+h*0.78;
    ctx.strokeStyle='rgba(245,158,11,0.22)'; ctx.lineWidth=0.75;
    ctx.beginPath(); ctx.moveTo(cx2,ly0); ctx.lineTo(cx2,ly1); ctx.stroke();
    const bfw=Math.round(w*0.22),bfh=Math.round(h*0.18),off=Math.round(w*0.24);
    [['true','#22c55e'],['false','#ef4444']].forEach(([label,clr],i)=>{
      const bfx=cx2+(i===0?-off:off);
      ctx.strokeStyle=clr+'2a'; ctx.lineWidth=0.75;
      ctx.beginPath(); ctx.moveTo(cx2,ly1); ctx.lineTo(bfx,ly1); ctx.stroke();
      ctx.fillStyle=clr+'12'; rrect(bfx-bfw/2,ly1,bfw,bfh,4); ctx.fill();
      ctx.strokeStyle=clr+'44'; ctx.lineWidth=0.75; rrect(bfx-bfw/2,ly1,bfw,bfh,4); ctx.stroke();
      ctx.fillStyle=clr+'bb'; ctx.font=`600 ${Math.max(7,Math.round(bfh*0.5))}px Inter`;
      ctx.textAlign='center'; ctx.textBaseline='middle'; ctx.fillText(label,bfx,ly1+bfh/2);
    });
  }
  function drawCRM(lx,ty,w,h){
    const pad=14,fx=lx+pad,fs=Math.max(8,Math.round(h*0.135)),lineH=Math.round(h*0.28);
    [{label:'Email:',value:'outreach@company.io',vc:'rgba(241,245,249,0.7)'},
     {label:'Limit:',value:'30/day  ‚óè Active',   vc:'rgba(34,197,94,0.85)'},
     {label:'Mode:',value:'Smart Sending on',     vc:'rgba(148,163,184,0.5)'}
    ].forEach((f,i)=>{
      const fy=ty+Math.round(h*0.16)+i*lineH;
      ctx.fillStyle='rgba(255,255,255,0.02)'; rrect(fx-4,fy-lineH*0.28,w-pad+4,lineH*0.72,3); ctx.fill();
      ctx.fillStyle='rgba(100,116,139,0.68)'; ctx.font=`500 ${fs}px Inter`;
      ctx.textAlign='left'; ctx.textBaseline='middle'; ctx.fillText(f.label,fx,fy);
      ctx.fillStyle=f.vc; ctx.font=`400 ${fs}px Inter`;
      ctx.fillText(f.value,fx+Math.round(w*0.24),fy);
    });
  }
  function drawSlack(lx,ty,w,h){
    const pad=14,fx=lx+pad,fs=Math.max(8,Math.round(h*0.135));
    ctx.fillStyle='rgba(59,130,246,0.12)'; rrect(fx,ty+h*0.1,Math.round(w*0.34),20,3); ctx.fill();
    ctx.fillStyle='rgba(147,197,253,0.75)'; ctx.font=`500 ${fs}px Inter`;
    ctx.textAlign='left'; ctx.textBaseline='middle'; ctx.fillText('# general',fx+6,ty+h*0.2);
    ctx.fillStyle='rgba(241,245,249,0.6)'; ctx.font=`400 ${Math.max(7,fs-1)}px Inter`;
    ctx.fillText('Lead batch processed ‚Üí',fx,ty+h*0.46);
    ctx.strokeStyle='rgba(255,255,255,0.05)'; ctx.lineWidth=0.5;
    ctx.beginPath(); ctx.moveTo(lx+6,ty+h*0.62); ctx.lineTo(lx+w-6,ty+h*0.62); ctx.stroke();
    ctx.fillStyle='#22c55e'; ctx.beginPath(); ctx.arc(fx+4,ty+h*0.78,3,0,Math.PI*2); ctx.fill();
    ctx.fillStyle='rgba(148,163,184,0.5)'; ctx.font=`400 ${fs}px Inter`;
    ctx.fillText('3 messages sent',fx+13,ty+h*0.78);
  }
  function drawDone(lx,ty,w,h){
    const cx2=lx+w/2,cy2=ty+h*0.46,fs=Math.max(8,Math.round(h*0.13)),r2=Math.round(h*0.26);
    ctx.fillStyle='rgba(124,58,237,0.1)'; ctx.beginPath(); ctx.arc(cx2,cy2,r2,0,Math.PI*2); ctx.fill();
    ctx.strokeStyle='rgba(124,58,237,0.3)'; ctx.lineWidth=1; ctx.stroke();
    ctx.fillStyle='rgba(167,139,250,0.85)'; ctx.font=`${Math.round(r2*1.1)}px serif`;
    ctx.textAlign='center'; ctx.textBaseline='middle'; ctx.fillText('‚úì',cx2,cy2);
    ctx.fillStyle='rgba(241,245,249,0.65)'; ctx.font=`400 ${fs}px Inter`;
    ctx.fillText('6 leads processed',cx2,ty+h*0.82);
  }

  /* ‚îÄ‚îÄ main node card ‚Äî clean, no glow ‚îÄ‚îÄ */
  function drawNode(n) {
    const ncx=cx(n), ncy=cy(n), lx=ncx-NW/2, ty=ncy-NH/2, r=10;
    const contentH=Math.round(NH*0.57), infoH=NH-contentH, ipad=14;
    /* skip if off screen */
    if(lx>W+4||lx+NW<-4||ty>H+4||ty+NH<-4) return;
    /* card ‚Äî dark, flat, clean drop-shadow only */
    ctx.save();
    ctx.shadowColor='rgba(0,0,0,0.55)'; ctx.shadowBlur=18; ctx.shadowOffsetY=6;
    ctx.fillStyle='#131323'; rrect(lx,ty,NW,NH,r); ctx.fill();
    ctx.restore();
    /* border ‚Äî very subtle */
    ctx.strokeStyle='rgba(255,255,255,0.1)'; ctx.lineWidth=1; rrect(lx,ty,NW,NH,r); ctx.stroke();
    /* clip interior */
    ctx.save(); rrect(lx,ty,NW,NH,r); ctx.clip();
    ctx.fillStyle='rgba(255,255,255,0.016)'; ctx.fillRect(lx,ty,NW,contentH);
    /* top accent ‚Äî 2px colored line */
    ctx.fillStyle=n.color+'88'; ctx.fillRect(lx,ty,NW,2);
    /* content/info divider */
    ctx.strokeStyle='rgba(255,255,255,0.06)'; ctx.lineWidth=0.75;
    ctx.beginPath(); ctx.moveTo(lx,ty+contentH); ctx.lineTo(lx+NW,ty+contentH); ctx.stroke();
    ctx.restore();
    /* content preview */
    switch(n.preview){
      case 'trigger': drawTrigger(lx,ty,NW,contentH); break;
      case 'table':   drawTable(lx,ty,NW,contentH);   break;
      case 'if':      drawIF(lx,ty,NW,contentH);      break;
      case 'crm':     drawCRM(lx,ty,NW,contentH);     break;
      case 'slack':   drawSlack(lx,ty,NW,contentH);   break;
      case 'done':    drawDone(lx,ty,NW,contentH);    break;
    }
    /* info bar */
    const iy=ty+contentH, namey=iy+Math.round(infoH*0.34), typey=iy+Math.round(infoH*0.70);
    ctx.fillStyle='rgba(241,245,249,0.88)'; ctx.font='700 13px Inter';
    ctx.textAlign='left'; ctx.textBaseline='middle'; ctx.fillText(n.title,lx+ipad,namey);
    ctx.fillStyle='rgba(100,116,139,0.65)'; ctx.font='400 10px Inter';
    ctx.fillText(n.type,lx+ipad,typey);
    /* status */
    const stx=lx+NW-ipad, dotX=stx-50;
    const dp=0.55+0.45*Math.sin(t2*2.2+n.wx*0.008);
    ctx.fillStyle=n.status==='Active'?`rgba(34,197,94,${dp.toFixed(2)})`:`rgba(59,130,246,${dp.toFixed(2)})`;
    ctx.beginPath(); ctx.arc(dotX,typey,3,0,Math.PI*2); ctx.fill();
    ctx.fillStyle='rgba(100,116,139,0.58)'; ctx.font='400 10px Inter';
    ctx.textAlign='right'; ctx.fillText(n.status,stx,typey);
    /* ports ‚Äî clean rings, no glow */
    const pr=5;
    ctx.fillStyle='#131323'; ctx.beginPath(); ctx.arc(ncx+NW/2,ncy,pr+2,0,Math.PI*2); ctx.fill();
    ctx.fillStyle=n.color+'99'; ctx.beginPath(); ctx.arc(ncx+NW/2,ncy,pr,0,Math.PI*2); ctx.fill();
    ctx.strokeStyle='rgba(255,255,255,0.18)'; ctx.lineWidth=1; ctx.stroke();
    ctx.fillStyle='#131323'; ctx.beginPath(); ctx.arc(lx,ncy,pr+1,0,Math.PI*2); ctx.fill();
    ctx.strokeStyle='rgba(255,255,255,0.12)'; ctx.lineWidth=1;
    ctx.beginPath(); ctx.arc(lx,ncy,pr,0,Math.PI*2); ctx.fill(); ctx.stroke();
  }

  /* drag hint ‚Äî fades after 3s */
  function drawHint() {
    const alpha = Math.max(0, 1 - (t2 - 1) / 2);
    if (alpha <= 0) return;
    ctx.fillStyle = `rgba(148,163,184,${(alpha * 0.45).toFixed(2)})`;
    ctx.font = '400 11px Inter'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
    ctx.fillText('‚Üê drag to explore the full workflow ‚Üí', W/2, H - 16);
  }

  function animate2() {
    ctx.clearRect(0,0,W,H); drawDots(); t2 += 0.016;
    /* momentum */
    if (!isDragging && (Math.abs(velX)>0.3||Math.abs(velY)>0.3)) {
      panX+=velX; panY+=velY; velX*=0.88; velY*=0.88;
      if(Math.abs(velX)<0.3)velX=0; if(Math.abs(velY)<0.3)velY=0;
    }
    const nm={}; nodes.forEach(n=>nm[n.id]=n);
    edges.forEach(([a,b],i)=>drawEdge(nm[a],nm[b],i));
    nodes.forEach(drawNode);
    drawHint();
    animId2=requestAnimationFrame(animate2);
  }
  const obs2=new IntersectionObserver(entries=>{
    if(entries[0].isIntersecting){resize();animate2();}
    else cancelAnimationFrame(animId2);
  });
  obs2.observe(canvas);
  window.addEventListener('resize',()=>{ W=canvas.width=canvas.offsetWidth; H=canvas.height=canvas.offsetHeight; });
})();


/* ‚îÄ‚îÄ GSAP Animations ‚îÄ‚îÄ */
// Hero entrance
const heroTl = gsap.timeline();
heroTl
  .from('.hero-tag', { opacity:0, y:20, duration:0.6, ease:'power2.out' })
  .from('h1', { opacity:0, y:40, duration:0.8, ease:'power3.out' }, '-=0.2')
  .from('.hero-sub', { opacity:0, y:30, duration:0.7, ease:'power2.out' }, '-=0.4')
  .from('.hero-actions', { opacity:0, y:20, duration:0.6, ease:'power2.out' }, '-=0.3');

// Parallax orbs
gsap.to('.orb-1', {
  yPercent: -30, ease:'none',
  scrollTrigger: { trigger:'#hero', start:'top top', end:'bottom top', scrub:1.5 }
});
gsap.to('.orb-2', {
  yPercent: -50, ease:'none',
  scrollTrigger: { trigger:'#hero', start:'top top', end:'bottom top', scrub:2 }
});

// Fade-up cards
gsap.utils.toArray('.fade-up').forEach((el, i) => {
  gsap.to(el, {
    opacity:1, y:0, duration:0.7, ease:'power2.out',
    scrollTrigger: { trigger:el, start:'top 85%', toggleActions:'play none none none' },
    delay: (i % 3) * 0.1
  });
});

// Steps
gsap.utils.toArray('.step').forEach((el, i) => {
  gsap.to(el, {
    opacity:1, x:0, duration:0.7, ease:'power2.out',
    scrollTrigger: { trigger:el, start:'top 88%' },
    delay: i * 0.08
  });
});

// Section headers
gsap.utils.toArray('h2').forEach(el => {
  gsap.from(el, {
    opacity:0, y:30, duration:0.8, ease:'power2.out',
    scrollTrigger: { trigger:el, start:'top 88%' }
  });
});

// Stats counter
gsap.utils.toArray('.stat-num').forEach(el => {
  const target = +el.dataset.target;
  ScrollTrigger.create({
    trigger: el, start:'top 85%', once:true,
    onEnter: () => gsap.to({ val:0 }, {
      val: target, duration:1.8, ease:'power2.out',
      onUpdate: function() { el.textContent = Math.round(this.targets()[0].val); },
      onComplete: () => {
        el.textContent = target;
        if (el.nextElementSibling.textContent.includes('%')) el.textContent = target + '%';
        else if (el.nextElementSibling.textContent.includes('Day')) el.textContent = target;
        else if (el.nextElementSibling.textContent.includes('Hour')) el.textContent = target + '+';
        else el.textContent = target + '+';
      }
    })
  });
});

// Parallax on workflow section background
gsap.to('#workflow', {
  backgroundPositionY:'30%',
  ease:'none',
  scrollTrigger: { trigger:'#workflow', start:'top bottom', end:'bottom top', scrub:1 }
});

// Nav active link highlight
const sections = document.querySelectorAll('section[id]');
sections.forEach(sec => {
  ScrollTrigger.create({
    trigger: sec, start:'top 60%', end:'bottom 60%',
    onEnter: () => highlightNav(sec.id),
    onEnterBack: () => highlightNav(sec.id),
  });
});
function highlightNav(id) {
  document.querySelectorAll('.nav-links a').forEach(a => {
    a.style.color = a.getAttribute('href') === '#'+id ? '#f1f5f9' : '';
  });
}
</script>
</body>
</html>
